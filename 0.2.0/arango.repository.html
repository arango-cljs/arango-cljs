<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>arango.repository documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Forest 0.2.0 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>arango</span></div></div></li><li class="depth-2 branch"><a href="arango.console.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>console</span></div></a></li><li class="depth-2 branch"><a href="arango.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="arango.fs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fs</span></div></a></li><li class="depth-2 branch"><a href="arango.http-client.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>http-client</span></div></a></li><li class="depth-2 current"><a href="arango.repository.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>repository</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>forest</span></div></div></li><li class="depth-2 branch"><a href="forest.coerce.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>coerce</span></div></a></li><li class="depth-2 branch"><a href="forest.destructuring.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>destructuring</span></div></a></li><li class="depth-2"><a href="forest.middleware.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-3"><a href="forest.middleware.edn.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>edn</span></div></a></li><li class="depth-2 branch"><a href="forest.response.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>response</span></div></a></li><li class="depth-2"><a href="forest.route.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>route</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="arango.repository.html#var--.3EFoxxRepository"><div class="inner"><span>-&gt;FoxxRepository</span></div></a></li><li class="depth-1"><a href="arango.repository.html#var-app-repository"><div class="inner"><span>app-repository</span></div></a></li><li class="depth-1"><a href="arango.repository.html#var-ArangoCollection"><div class="inner"><span>ArangoCollection</span></div></a></li><li class="depth-2 branch"><a href="arango.repository.html#var-add"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>add</span></div></a></li><li class="depth-2 branch"><a href="arango.repository.html#var-by-example"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>by-example</span></div></a></li><li class="depth-2 branch"><a href="arango.repository.html#var-replace-by-id"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>replace-by-id</span></div></a></li><li class="depth-2 branch"><a href="arango.repository.html#var-replace-by-example"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>replace-by-example</span></div></a></li><li class="depth-2 branch"><a href="arango.repository.html#var-update-by-id"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>update-by-id</span></div></a></li><li class="depth-2 branch"><a href="arango.repository.html#var-remove-by-id"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>remove-by-id</span></div></a></li><li class="depth-2 branch"><a href="arango.repository.html#var-update-by-example"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>update-by-example</span></div></a></li><li class="depth-2 branch"><a href="arango.repository.html#var-key-range"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>key-range</span></div></a></li><li class="depth-2 branch"><a href="arango.repository.html#var-by-id"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>by-id</span></div></a></li><li class="depth-2 branch"><a href="arango.repository.html#var-remove-entry"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>remove-entry</span></div></a></li><li class="depth-2 branch"><a href="arango.repository.html#var-fulltext"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fulltext</span></div></a></li><li class="depth-2 branch"><a href="arango.repository.html#var-remove-by-example"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>remove-by-example</span></div></a></li><li class="depth-2 branch"><a href="arango.repository.html#var-all"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>all</span></div></a></li><li class="depth-2 branch"><a href="arango.repository.html#var-count-all"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>count-all</span></div></a></li><li class="depth-2 branch"><a href="arango.repository.html#var-replace-entry"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>replace-entry</span></div></a></li><li class="depth-2 branch"><a href="arango.repository.html#var-first-example"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>first-example</span></div></a></li><li class="depth-2 branch"><a href="arango.repository.html#var-within"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>within</span></div></a></li><li class="depth-2"><a href="arango.repository.html#var-near"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>near</span></div></a></li><li class="depth-1"><a href="arango.repository.html#var-create-collection.21"><div class="inner"><span>create-collection!</span></div></a></li><li class="depth-1"><a href="arango.repository.html#var-drop-collection.21"><div class="inner"><span>drop-collection!</span></div></a></li><li class="depth-1"><a href="arango.repository.html#var-FoxxRepository"><div class="inner"><span>FoxxRepository</span></div></a></li><li class="depth-1"><a href="arango.repository.html#var-map-.3EFoxxRepository"><div class="inner"><span>map-&gt;FoxxRepository</span></div></a></li><li class="depth-1"><a href="arango.repository.html#var-truncate-collection.21"><div class="inner"><span>truncate-collection!</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">arango.repository</h2><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var--.3EFoxxRepository"><h3>-&gt;FoxxRepository</h3><div class="usage"><code>(-&gt;FoxxRepository repo schema)</code></div><div class="doc"><div class="markdown"><p>A repository is a gateway to the database. It gets data from the database, updates it or adds brand-new data. Conversion between Javascript and Clojure datastructure is done automatically.</p></div></div><div class="src-link"><a href="http://github.com/arango-cljs/forest/blob/0.2.0/src/arango/repository.cljs#L150">view source</a></div></div><div class="public anchor" id="var-app-repository"><h3>app-repository</h3><div class="usage"><code>(app-repository repo schema)</code><code>(app-repository repo schema indexes)</code></div><div class="doc"><div class="markdown"><p>Creates a new instance of Repo inside current application context.</p><p>Repository can take care of ensuring the existence of collection indexes for you. If you define indexes for a repository, instances of the repository will have access to additional index-specific methods like <code>range</code> or <code>fulltext</code>.</p><p>Parameters:</p>
<ul>
  <li><code>repo</code>: name of the repo, as string</li>
  <li><code>schema</code>: the <em>schema</em> against which entries will be validated and coerced.</li>
  <li><code>indexes</code> (optional): a vector of indexes.
  <ul>
    <li>For example: <code>[{:type :fulltext, :fields [:text], :minLength 3}]</code></li>
  </ul></li>
</ul></div></div><div class="src-link"><a href="http://github.com/arango-cljs/forest/blob/0.2.0/src/arango/repository.cljs#L254">view source</a></div></div><div class="public anchor" id="var-ArangoCollection"><h3>ArangoCollection</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>ArangoDB collection</p></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-add"><h3>add</h3><div class="usage"><code>(add this entry)</code></div><div class="doc"><div class="markdown"><p>Saves an <code>entry</code> into the database. This <code>entry</code> can be any Clojure data structure. Will set the <code>:_id</code> and <code>:_rev</code> on the entry. Returns the entry.</p></div></div></div><div class="public anchor" id="var-by-example"><h3>by-example</h3><div class="usage"><code>(by-example this example)</code></div><div class="doc"><div class="markdown"><p>Returns a vector of entries for the given <code>example</code>.</p></div></div></div><div class="public anchor" id="var-replace-by-id"><h3>replace-by-id</h3><div class="usage"><code>(replace-by-id this id entry)</code></div><div class="doc"><div class="markdown"><p>Finds the entry in the database by the given <code>:_id</code> and replaces it with the given <code>entry</code>. Sets the <code>:_id</code> and <code>:_rev</code> of the entry. Returns <code>nil</code>.</p></div></div></div><div class="public anchor" id="var-replace-by-example"><h3>replace-by-example</h3><div class="usage"><code>(replace-by-example this example entry)</code></div><div class="doc"><div class="markdown"><p>Finds the entry in the database by the given <code>example</code> and replaces it with the given <code>entry</code>. Sets the <code>:_id</code> and <code>:_rev</code> of the entry. Returns <code>nil</code>.</p></div></div></div><div class="public anchor" id="var-update-by-id"><h3>update-by-id</h3><div class="usage"><code>(update-by-id this id data)</code></div><div class="doc"><div class="markdown"><p>Finds an entry by <code>:_id</code> and update it with the keys/values in the provided data. Returns <code>nil</code>.</p></div></div></div><div class="public anchor" id="var-remove-by-id"><h3>remove-by-id</h3><div class="usage"><code>(remove-by-id this id)</code></div><div class="doc"><div class="markdown"><p>Removes the entry with the given <code>:_id</code>. Expects an <code>:_id</code> of an existing entry.</p></div></div></div><div class="public anchor" id="var-update-by-example"><h3>update-by-example</h3><div class="usage"><code>(update-by-example this example data)</code></div><div class="doc"><div class="markdown"><p>Finds an entry by <code>example</code> and update it with the key/values in the provided <code>data</code>. Returns <code>nil</code>.</p></div></div></div><div class="public anchor" id="var-key-range"><h3>key-range</h3><div class="usage"><code>(key-range this key left right)</code></div><div class="doc"><div class="markdown"><p>Returns all entries in the repository such that the <code>key</code> is greater than or equal to <code>left</code> and strictly less than <code>right</code>.</p><p>For range queries it is required that a <em>skiplist</em> index is present for the queried <code>key</code>. If no <em>skiplist</em> index is present on the <code>key</code>, the method will not be available.</p><p>Parameters:</p>
<ul>
  <li><code>key</code>: key to query.</li>
  <li><code>left</code>: lower bound of the value range (inclusive).</li>
  <li><code>right</code>: upper bound of the value range (exclusive).</li>
</ul></div></div></div><div class="public anchor" id="var-by-id"><h3>by-id</h3><div class="usage"><code>(by-id this id)</code></div><div class="doc"><div class="markdown"><p>Returns the entry for the given <code>:_id</code>.</p></div></div></div><div class="public anchor" id="var-remove-entry"><h3>remove-entry</h3><div class="usage"><code>(remove-entry this entry)</code></div><div class="doc"><div class="markdown"><p>Removes the entry from the repository.</p></div></div></div><div class="public anchor" id="var-fulltext"><h3>fulltext</h3><div class="usage"><code>(fulltext this key text)</code><code>(fulltext this key text limit)</code></div><div class="doc"><div class="markdown"><p>Returns all entries whose <code>key</code> value matches the search query <code>text</code>.</p><p>In order to use the <code>fulltext</code> method, a <em>fulltext</em> index must be defined on the repository. If multiple <em>fulltext</em> indexes are defined on the repository for the key, the most capable one will be selected. If no <em>fulltext</em> index is present, the method will not be available.</p><p>Parameter:</p>
<ul>
  <li><code>key</code>: entry key to perform a search on.</li>
  <li><code>text</code>: text query to match the key&rsquo;s value against.</li>
  <li><code>limit</code> (optional): number of entries to return. Defaults to <em>all</em>.</li>
</ul></div></div></div><div class="public anchor" id="var-remove-by-example"><h3>remove-by-example</h3><div class="usage"><code>(remove-by-example this example)</code></div><div class="doc"><div class="markdown"><p>Finds all entries that fit this <code>example</code> and removes them.</p></div></div></div><div class="public anchor" id="var-all"><h3>all</h3><div class="usage"><code>(all this)</code><code>(all this options)</code></div><div class="doc"><div class="markdown"><p>Returns a vector of entries that matches the given <code>example</code>. You can provide both a <code>skip</code> and a <code>limit</code> value.</p><p>Parameters:</p>
<ul>
  <li><code>options</code> (optional):
  <ul>
    <li><code>skip</code> (optional): skips the first given number of entries.</li>
    <li><code>limit</code> (optional): only returns at most the given number of entries.</li>
  </ul></li>
</ul></div></div></div><div class="public anchor" id="var-count-all"><h3>count-all</h3><div class="usage"><code>(count-all this)</code></div><div class="doc"><div class="markdown"><p>Returns the number of entries in this collection.</p></div></div></div><div class="public anchor" id="var-replace-entry"><h3>replace-entry</h3><div class="usage"><code>(replace-entry this entry)</code></div><div class="doc"><div class="markdown"><p>Finds the entry in the database by its <code>:_id</code> and replace it with this version. Expects an <code>entry</code>. Sets the <code>:_rev</code> of the entry. Returns <code>nil</code>.</p></div></div></div><div class="public anchor" id="var-first-example"><h3>first-example</h3><div class="usage"><code>(first-example this example)</code></div><div class="doc"><div class="markdown"><p>Returns the first entry that matches the given <code>example</code>.</p></div></div></div><div class="public anchor" id="var-within"><h3>within</h3><div class="usage"><code>(within this lat lng radius)</code><code>(within this lat lng radius options)</code></div><div class="doc"><div class="markdown"><p>Finds entries within the distance radius from the coordinate (latitude, longitude). The returned vector is sorted by distance with the nearest entry coming first.</p><p>For geo queries it is required that a <em>geo</em> index is present in the repository. If no <em>geo</em> index is present, the methods will not be available.</p><p>Parameters:</p>
<ul>
  <li><code>lat</code>: latitude of the coordinate.</li>
  <li><code>lng</code>: longitude of the coordinate.</li>
  <li><code>radius</code>: maximum distance from the coordinate.</li>
  <li><code>options</code> (optional):
  <ul>
    <li><code>:geo</code> (optional): name of the specific <em>geo</em> index to use.</li>
    <li><code>:distance</code> (optional): If set to a truthy value, the returned entries  will have an additional key containing the distance between the given coordinate  and the entry. If the value is a keyword, that value will be used as the  key name, otherwise the name defaults to <code>:distance</code>.</li>
    <li><code>:limit</code> (optional): number of entries to return. Defaults to <code>100</code>.</li>
  </ul></li>
</ul></div></div></div><div class="public anchor" id="var-near"><h3>near</h3><div class="usage"><code>(near this lat lng)</code><code>(near this lat lng options)</code></div><div class="doc"><div class="markdown"><p>Finds entries near the coordinate (latitude, longitude). The returned vector is sorted by distance with the nearest entry coming first.</p><p>For geo queries it is required that a <em>geo</em> index is present in the repository. If no <em>geo</em> index is present, the methods will not be available.</p><p>Parameters:</p>
<ul>
  <li><code>lat</code>: latitude of the coordinate.</li>
  <li><code>lng</code>: longitude of the coordinate.</li>
  <li><code>options</code> (optional):
  <ul>
    <li><code>:geo</code> (optional): name of the specific geo index to use.</li>
    <li><code>:distance</code> (optional): If set to a truthy value, the returned models will  have an additional key containing the distance between the given  coordinate and the entry. If the value is a string, that value will be  used as the key name, otherwise the name defaults to <code>:distance</code>.</li>
    <li><code>:limit</code> (optional): number of entries to return. Defaults to <code>100</code>.</li>
  </ul></li>
</ul></div></div></div></div></div><div class="src-link"><a href="http://github.com/arango-cljs/forest/blob/0.2.0/src/arango/repository.cljs#L21">view source</a></div></div><div class="public anchor" id="var-create-collection.21"><h3>create-collection!</h3><div class="usage"><code>(create-collection! coll-name)</code></div><div class="doc"><div class="markdown"><p>Creates a new collection with given name for current application context. Returns <code>true</code> if created successfully. Otherwise returns <code>nil</code>.</p></div></div><div class="src-link"><a href="http://github.com/arango-cljs/forest/blob/0.2.0/src/arango/repository.cljs#L282">view source</a></div></div><div class="public anchor" id="var-drop-collection.21"><h3>drop-collection!</h3><div class="usage"><code>(drop-collection! coll-name)</code></div><div class="doc"><div class="markdown"><p>Deletes a new collection with given name for current application context. Returns <code>true</code> if deleted successfully. Otherwise returns <code>nil</code>.</p></div></div><div class="src-link"><a href="http://github.com/arango-cljs/forest/blob/0.2.0/src/arango/repository.cljs#L292">view source</a></div></div><div class="public anchor" id="var-FoxxRepository"><h3>FoxxRepository</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>A repository is a gateway to the database. It gets data from the database, updates it or adds brand-new data. Conversion between Javascript and Clojure datastructure is done automatically.</p></div></div><div class="src-link"><a href="http://github.com/arango-cljs/forest/blob/0.2.0/src/arango/repository.cljs#L153">view source</a></div></div><div class="public anchor" id="var-map-.3EFoxxRepository"><h3>map-&gt;FoxxRepository</h3><div class="usage"><code>(map-&gt;FoxxRepository G__7929)</code></div><div class="doc"><div class="markdown"><p>A repository is a gateway to the database. It gets data from the database, updates it or adds brand-new data. Conversion between Javascript and Clojure datastructure is done automatically.</p></div></div><div class="src-link"><a href="http://github.com/arango-cljs/forest/blob/0.2.0/src/arango/repository.cljs#L150">view source</a></div></div><div class="public anchor" id="var-truncate-collection.21"><h3>truncate-collection!</h3><div class="usage"><code>(truncate-collection! coll-name)</code></div><div class="doc"><div class="markdown"><p>Truncates a collection with given name for current application context, removing all documents but keeping all its indexes. Returns <code>true</code> if deleted successfully. Otherwise returns <code>nil</code>.</p></div></div><div class="src-link"><a href="http://github.com/arango-cljs/forest/blob/0.2.0/src/arango/repository.cljs#L302">view source</a></div></div></div></body></html>